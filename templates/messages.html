<!DOCTYPE html>
<html lang="fr">

<head>
  <!-- language utf8 pour indiquer l'encodage -->
  <meta charset="UTF-8">
  <!-- pour l'adapter plus ou moins bien sur telephone -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- titre en haut dans le navigateur -->
  <title>Messages</title>
  <!-- page de style -->
  <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='styles/style.css')}}">
  <!-- on inclut la bibliothèque depuis les serveurs de Google -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css">
  <script src="https://kit.fontawesome.com/87544e3da3.js" crossorigin="anonymous"></script>
  <script src="{{url_for('static',filename='js/message.js')}}" type="text/javascript"></script>
  <script src="{{url_for('static',filename='js/menu.js')}}" type="text/javascript"></script>
</head>

<!-- overflow est la barre pour baisser la page, on l enleve pour en mettre que une dans les messages -->

<body style="overflow:hidden;height:100%;width:99%;">
  {% include "bandeau.html" %}
  <!-- div qui contient tt le reste de la page avec les messages et l'affichage des groupe -->
  <div class="contentmessage">
    <!-- div pour afficher tout les groupes -->
    <div id="nomgroupe">
      <div class="liengroupe" >
        <img onclick="divnewgroup()" style="width: 30px;height:auto;margin-bottom:5%;" src="{{url_for('static',filename='image/plus.png')}}" />
      </div>
      <div id="newgroup" style="height:200px; overflow-y:auto;">
        <form autocomplete="off">
            <h2>Créer un nouveau groupe</h2><br /><br />
            <label for="nomnewgroupe">Nom du groupe</label> :   <input type="text" name="nomnewgroupe" id="nomnewgroupe" maxlength='25'/><br><br>
            <input type="checkbox" name=1 id="pseudo" /><label for="pseudo">perso1</label><br><br />
            <input type="submit" value="Valider" />
        </form>
      </div>
      <!-- div pour le groupe -->
      {%for content in grpUtilisateur%}
      <div class="groupe">
        <!-- lien vers le 1er groupe (ne marche pas) en gras car c'est le groupe sur lequel on est  -->
        <a class="liengroupe current" href="{{url_for('messages', idGroupe=content['_id'])}}">
            {{content['nom']}}
          </a>
      </div>
      {%endfor%}
    </div>
    <!-- fin de la div pour les noms de tt les groupes -->
    {% if msgDb != None %}
    <!-- debut de la div pour la partie de droite avec le nom du groupe ouvert avec les messages -->
    <div id="titreetmsg">
      <!-- debut de la div pour la partie haute a droite -->
      <div class="titregroupe">
        <!-- div avec le nom du groupe et les paticipant -->
        <div class="nomgroupeparticipents">
          <!-- nom du groupe -->
          <h2>{{infogroupe['nom']}}</h2>
          <!-- liste des paricipant -->
          <p>
            {%for content in infoUtilisateurs%} {{content['nom']}}, {%endfor%}
          </p>
        </div>
        <!-- les trois petit points a droite -->
        <a href="messages.html"><img src="{{url_for('static',filename='image/3points.png')}}" style="width: 20px;height:auto;margin-bottom:5px;" /></a>
      </div>
      <!-- div avec les message, le overflow est activer pour pouvoir defiler tt les msg -->
      <div class="messages" style="box-sizing: border-box;overflow-y: auto;">
        {% for content in msgDb%} <!--Pour chaque message -->
        <div class="participantmsg" style="background-color:#8dd7cf;">
          <p style="font-weight: bold;margin:0px">{%for useurs in infoUtilisateurs %}{%if useurs['_id']==content['id-utilisateur']%}{{useurs['pseudo']}}{%endif%}{%endfor%}</p>
          <br>
          <p style="margin:0px">
            {{content['contenu']}} <!--On affiche le contenu du message -->
          </p>
          <br>
          <p class="date" style="margin:0px;text-align:right;">le {{content['date-envoi'].day}}/{{content['date-envoi'].month}} à {{content['date-envoi'].hour}}h{{content['date-envoi'].minute}}</p>
        </div>
        {%endfor%}
        <!-- msg ecrit par moi (a droite) -->
        <div class="moimsg">
          <p style="margin:0px">
            Trop cool le fifty fifty
          </p>
          <br>
          <p class="date" style="margin:0px;text-align:right;">le 20/03 à 17h46</p>
        </div>
      </div>
      <!-- fin de tt les msg -->
      <form method="post" class="barreenvoi" id="messageForm" onsubmit="envoi(event); return false;">
          <img src="{{url_for('static',filename='image/photo.png')}}" class="iconebarremsg" />
          <input type="text" placeholder="Envoyer un message" autocomplete='off' name="contenuMessage" style="width: 75%;margin-left: 2%;padding:5px;">
          <input type='hidden' name="group" value="{{idgroupe}}" />
          <button style="background-color:white;border: 0px solid white;" type="submit"><img src="{{url_for('static',filename='image/flecheenvoi.png')}}" class="iconebarremsg" /></button>
      </form>
    </div>
    <!-- fin de la div pour la partie de droite -->
    {% endif %}
  </div>
  <!-- fin de la div pour tt ce qui concerne le msg (tt sauf la barre du haut) -->

</body>

</html>
